# JavaPrac — Сайт библиотеки

Данный проект реализует веб-приложение для учёта читателей, книг и операций выдачи/приёма в библиотеке. Ниже приведены сценарии использования, описание страниц и схема навигации.

---

## 1. Перечень и описание сценариев использования

### 1.1. Получение списка читателей и книг

**Список читателей:**

1. Пользователь переходит на главную страницу.
2. Выбирает раздел «Читатели».
3. На странице «Читатели» отображается полный список зарегистрированных читателей.
4. При необходимости использует поиск и фильтрацию по имени, фамилии, ID и т.п.

**Список книг:**

1. Пользователь переходит на главную страницу.
2. Выбирает раздел «Книги».
3. На странице «Книги» отображается каталог всех книг библиотеки.
4. При необходимости фильтрует книги по авторам, названиям и издательствам.

---

### 1.2. Получение истории выдачи и приёма книг у читателя и списка находящихся у него книг

1. Пользователь переходит в раздел «Читатели» и выбирает нужного читателя.
2. Открывается страница «Читатель» с данными выбранного читателя.
3. На странице отображается список книг, которые в данный момент находятся у читателя.
4. На этой же странице доступна история всех операций выдачи и приёма книг для данного читателя с датами и статусами.

---

### 1.3. Получение истории выдачи и приёма экземпляров книги и сводных сведений за интервал времени

Сценарий выполняется через страницу **«История выдачи и приёма»**.

1. Пользователь переходит на страницу «История выдачи и приёма» (с главной).
2. На странице отображаются выданные экземпляры и операции выдачи/приёма.
3. Пользователь задаёт интервал времени с помощью фильтра по датам (дата начала и окончания).
4. Система показывает сводные сведения о наличии, выдаче и приёме книг за выбранный период.
5. Чтобы отфильтровать записи по конкретной книге, в поиске достаточно указать её **ISBN** — список отобразит только историю по этой книге.

---

### 1.4. Внесение информации о выдаче книг читателю и получении от него

**Выдача книги:**

1. Пользователь переходит на страницу «Выдача книги» с главной.
2. Указывает читателя (номер читательского билета) и номер выдаваемой книги.
3. Подтверждает операцию выдачи.

**Приём книги:**

1. Пользователь переходит на страницу «Приём книги».
2. Указывает номер книги.
3. Подтверждает возврат.

---

### 1.5. Добавление и удаление читателя, чтение и редактирование данных о нём

**Добавление читателя:**

1. Пользователь открывает страницу «Читатели».
2. Нажимает «Добавить читателя».
3. Заполняет форму: имя, фамилия, телефон, адрес.
4. Подтверждает создание — в БД добавляется новая запись в таблицу читателей.

**Чтение данных о читателе:**

1. На странице «Читатели» пользователь выбирает читателя из списка.
2. Открывается страница «Читатель» с полной информацией: имя, фамилия, контакты, адрес, список книг и история выдачи/приёма.

**Редактирование данных о читателе:**

1. На странице «Читатель» пользователь переходит по ссылке «Редактирование информации о пользователе».
2. На форме отображаются текущие данные читателя.
3. Пользователь вносит изменения и сохраняет — данные в БД обновляются.

**Удаление читателя:**

1. На странице «Читатель» пользователь нажимает кнопку удаления читателя.
2. Система проверяет наличие активных выдач.
3. После подтверждения запись читателя удаляется из БД.

---

### 1.6. Добавление и удаление книги и отдельных экземпляров, чтение и редактирование данных о книгах и экземплярах

**Добавление книги:**

1. Пользователь открывает страницу «Книги».
2. Нажимает «Добавить книгу».
3. Заполняет данные: название, авторы, ISBN, издательство, год издания, статус.
4. Подтверждает — в каталог добавляется новая книга.

**Добавление экземпляра книги:**

1. Пользователь открывает страницу конкретной «Книги».
2. Выбирает действие «Добавить экземпляр».

**Чтение данных о книге и экземплярах:**

1. Со страницы «Книги» пользователь выбирает книгу — открывается страница «Книга».
2. На ней отображаются: название, авторы, ISBN, издательство, год, статус, список экземпляров и их статусы.
3. Выбор конкретного экземпляра ведёт на страницу «Экземпляр» с детальной информацией и историей выдачи/приёма.

**Редактирование книги:**

1. На странице «Книга» пользователь переходит в «Редактирование информации о книге».
2. Меняет нужные поля (название, авторы, издательство и т.д.) и сохраняет.

**Редактирование экземпляра:**

1. На странице «Экземпляр» пользователь переходит в «Редактирование информации об экземпляре».
2. Изменяет данные экземпляра (статус) и сохраняет.

**Удаление книги и экземпляров:**

1. Удаление экземпляра выполняется со страницы экземпляра (с учётом отсутствия активных выдач).
2. Удаление книги — с страницы «Книга» или «Книги», с проверкой связей с выдачей и экземплярами.

---

## 2. Перечень и описание страниц


| Страница                                     | Информация на странице                                                                                   | Доступные операции                                                                                                                               |
| -------------------------------------------- | -------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Главная**                                  | Обзор: Пять кнопок ведущих к книгам, читателям, выдаче книг, приему книг, истории выдачи и приеиа        | Переход к: приёму книги, читателям, книгам, выдаче книги, истории выдачи и приёма                                                                |
| **Приём книги**                              | Форма/интерфейс для регистрации возврата книги                                                           | Ввод номера экземпляра, подтверждение приёма, обновление статуса                                                                                 |
| **Читатели**                                 | Список всех читателей (поиск и фильтрация по текстовым данным пользователя)                              | Просмотр списка, поиск, добавление читателя, переход к карточке читателя                                                                         |
| **Читатель**                                 | Данные читателя (ФИО, телефон, адрес), список книг на руках, история выдачи/приёма                       | Просмотр данных, переход к редактированию информации о пользователе, удаление пользователя, переход к странице книги                             |
| **Книги**                                    | Каталог книг с фильтрацией по авторам, названиям, издательствам                                          | Просмотр списка, поиск/фильтр, добавление книги, переход к карточке книги                                                                        |
| **Книга**                                    | Описание книги (название, авторы, ISBN, издательство, год, статус), список экземпляров, история по книге | Просмотр, редактирование информации о книге, добавление экземпляров, удаление книги, переход к экземпляру, переход к читателю (кто держит книгу) |
| **Выдача книги**                             | Форма для регистрации выдачи                                                                             | Выбор читателя и экземпляра, подтверждение выдачи                                                                                                |
| **История выдачи и приёма**                  | Журнал всех операций выдачи и приёма, фильтры по периоду, книге, читателю                                | Просмотр истории, фильтрация по интервалу времени, формирование сводок                                                                           |
| **Экземпляр**                                | Данные экземпляра (ID, статус, состояние), мини-история выдачи/приёма                                    | Просмотр, переход к редактированию информации об экземпляре, удаление экземпляра                                                                 |
| **Редактирование информации о пользователе** | Форма с полями читателя (имя, фамилия, телефон, адрес)                                                   | Изменение данных и сохранение                                                                                                                    |
| **Редактирование информации о книге**        | Форма с полями книги (название, авторы, ISBN, издательство, год и т.д.)                                  | Изменение данных и сохранение                                                                                                                    |
| **Редактирование информации об экземпляре**  | Форма с полями экземпляра (статус, состояние и т.д.)                                                     | Изменение данных и сохранение                                                                                                                    |


---

## 3. Схема навигации между страницами

Переходы между страницами соответствуют схеме. Схему можно посмотреть на изображении по пути `img/page_scheme.jpg`.

C Каждой страницы можно попасть на главную нажав на название сайта в верхнем правом углу.

### 3.1. От главной страницы

- **Главная** → Приём книги  
- **Главная** → Читатели  
- **Главная** → Книги  
- **Главная** → Выдача книги  
- **Главная** → История выдачи и приёма

### 3.2. Раздел «Читатели»

- **Читатели** → **Читатель** (при выборе читателя из списка)  
- **Читатель** → Редактирование информации о пользователе  
- **Читатель** → Экземпляр (переход к экземпляру книги из списка книг читателя)

### 3.3. Раздел «Книги»

- **Книги** → **Книга** (при выборе книги из списка)  
- **Книга** → Редактирование информации о книге  
- **Книга** → Экземпляр (при выборе экземпляра)  
- **Книга** → Читатель (например, кто сейчас держит экземпляр)

### 3.4. Раздел «Экземпляр»

- **Экземпляр** → Редактирование информации об экземпляре

---

## 4. Схема базы данных

Учитываются экземпляры книг: выдаётся и принимается конкретный экземпляр (копия). Структуру БД можно посмотреть на схеме по пути `img/bd_scheme.png`.

### Таблицы

- **READER** (Читатели)  
  - `reader_id` (PK), `first_name`, `second_name`, `phone_number`, `adress`
- **BOOK** (Книги)  
  - `book_id` (PK), `book_name`, `authors`, `ISBN`, `publishing_house`, `publishing_year`
- **BOOK_COPY** (Экземпляры книг)  
  - `copy_id` (PK), `book_id` (FK → BOOK), `status` — отдельная физическая копия книги (наличие, выдача, состояние), `condition` - состояние книги (Новая, с маленькими дефектами, сильно изношенная)
- **BOOK_LEND** (Выдача/приём)  
  - `lend_id` (PK), `reader_id` (FK → READER), `book_id` (FK → BOOK), `status`, `date` (datetime) — запись о выдаче или приёме (привязка к книге и читателю; учёт экземпляров ведётся через связь книги с **BOOK_COPY**).

### Связи

- Один читатель — много записей в **BOOK_LEND** (по `reader_id`).
- Одна книга — много записей в **BOOK_LEND** (по `book_id`).
- Одна книга — много экземпляров в **BOOK_COPY** (по `book_id`): у каждого издания может быть несколько физических копий.

### Запуск
- Поднять контейнер `docker compose -f ./docker/docker-compose.yml up -d`
- Запустить файл сборки `ant build.xml`